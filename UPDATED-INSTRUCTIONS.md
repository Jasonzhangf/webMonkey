# Web Automation Orchestrator 插件测试指南（更新版）

## 重要更新

我们已经改进了元素选择方式，不再需要使用Ctrl+点击组合键。现在，当鼠标悬停在元素上时，元素会被高亮显示，并在旁边显示一个"选择此元素"按钮。点击该按钮即可选择元素。

## 安装和运行

### 1. 安装插件

1. 打开Chrome浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目中的 `plugin/dist` 目录

### 2. 运行测试服务器

```bash
node test-server.js
```

### 3. 访问测试页面

1. 测试控制台：http://localhost:8765
2. 简单测试页面：http://localhost:8765/simple-test（推荐初次测试使用）
3. 基本测试页面：http://localhost:8765/basic-test（最简单的测试页面）

## 测试流程

### 步骤1：连接插件到测试服务器

1. 点击Chrome工具栏中的插件图标
2. 在弹出窗口中点击"连接编排器"按钮
3. 如果连接成功，状态会变为"已连接到编排器"

### 步骤2：发送节点连接请求

1. 打开测试控制台：http://localhost:8765
2. 在右侧"发送测试消息"面板中，从下拉菜单选择"节点连接请求"
3. 点击"发送消息"按钮

### 步骤3：测试元素选择功能

1. 打开简单测试页面：http://localhost:8765/simple-test
2. 将鼠标悬停在页面元素上（如按钮、输入框等）
   - 元素应该会被高亮显示
   - 元素旁边会出现一个"选择此元素"按钮
3. 点击"选择此元素"按钮
4. 返回测试控制台，检查消息日志
   - 应该能看到一条"element_selected"类型的消息
   - 消息中应包含所选元素的详细信息

### 步骤4：测试操作定义功能

1. 在测试控制台中，再次选择"节点连接请求"模板
2. 修改JSON中的`connection_mode`字段，从`"element_selection"`改为`"operation_definition"`
3. 点击"发送消息"按钮
4. 返回测试页面，将鼠标悬停在元素上
5. 点击"选择此元素"按钮
6. 此时应该会弹出操作菜单
7. 在菜单中选择一种操作类型（如"点击"、"输入"等）
8. 根据需要设置操作参数
9. 点击"完成"按钮
10. 返回测试控制台，检查消息日志
    - 应该能看到一条"operation_defined"类型的消息
    - 消息中应包含所定义操作的详细信息

## 故障排除

### 插件无法连接到测试服务器

1. 确保测试服务器正在运行
2. 检查浏览器控制台是否有错误信息
3. 尝试重新加载插件

### 元素选择不工作

1. 确保已发送节点连接请求
2. 确保插件状态为"已连接"
3. 检查浏览器控制台是否有错误信息

### 操作菜单不显示

1. 确保connection_mode设置为"operation_definition"
2. 确保正确点击了"选择此元素"按钮
3. 检查浏览器控制台是否有错误信息

## 测试要点

1. **基本连接测试**：验证插件能否成功连接到测试服务器
2. **元素选择测试**：验证插件能否正确选择页面元素并生成元素定位器
3. **操作定义测试**：验证插件能否正确定义元素操作并发送操作定义消息
4. **断线重连测试**：验证插件在连接断开后能否自动重连